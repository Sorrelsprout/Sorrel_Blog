/**
 * Atropos 0.11.2
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2021 
 *
 * Released under the MIT License
 *
 * Released on: October 15, 2021
 */

function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var $=function(t,e){return t.querySelector(e)},$$=function(t,e){return t.querySelectorAll(e)},$setDuration=function(t,e){t.style.transitionDuration=e},$setTransform=function(t,e){t.style.transform=e},$setOpacity=function(t,e){t.style.opacity=e},$on=function(t,e,o,a){return t.addEventListener(e,o,a)},$off=function(t,e,o,a){return t.removeEventListener(e,o,a)},removeUndefinedProps=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};function Atropos(t){void 0===t&&(t={});var e,o,a,r,n,s,i,c,p,u,d,f=t,l=f.el,v=f.eventsEl,h={__atropos__:!0,params:_extends({activeOffset:50,shadowOffset:50,shadowScale:1,durationEnter:300,durationLeave:600,rotateLock:!0,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},removeUndefinedProps(t||{})),destroyed:!1,isActive:!1},m=h.params,y=!0,g=!0,x=function(t){var e=t.rotateXPercentage,o=void 0===e?0:e,a=t.rotateYPercentage,r=void 0===a?0:a,n=t.duration,s=t.opacityOnly;$$(l,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){$setDuration(t,n);var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===o&&0===r)s||$setTransform(t,"translate3d(0, 0, 0)"),e&&$setOpacity(t,e[0]);else{var a=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(a)||s||$setTransform(t,"translate3d("+-r*-a+"%, "+o*-a+"%, 0)"),e){var i=e[0],c=e[1],p=Math.max(Math.abs(o),Math.abs(r));$setOpacity(t,i+(c-i)*p/100)}}}))},L=function(t){"pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType||("pointerdown"===t.type&&t.preventDefault(),l.classList.add("atropos-active"),$setDuration(e,"0ms"),o=!1,n=void 0,s=void 0,y=!0,g=!0,$setTransform(a,"translate3d(0,0, "+m.activeOffset+"px)"),$setDuration(a,(m.rotateLock?m.durationEnter:0)+"ms"),p&&$setDuration(p,(m.rotateLock?m.durationEnter:0)+"ms"),h.isActive=!0,"function"==typeof m.onEnter&&m.onEnter())},T=function(t){o&&t.cancelable&&t.preventDefault()},M=function(t){if(m.rotate&&h.isActive){if("mouse"!==t.pointerType){if(!m.rotateTouch)return;t.preventDefault()}var a=t.clientX,r=t.clientY;i||(i=l.getBoundingClientRect()),l===v||c||(c=v.getBoundingClientRect());var p=0,d=0,f=i,$=f.top,L=f.left,T=f.width,M=f.height;if(l===v){var _=T/2,O=M/2,X=a-L,Y=r-$;d=m.rotateYMax*(X-_)/(T/2)*-1,p=m.rotateXMax*(Y-O)/(M/2)}else{var w=c,D=w.top,E=w.left,b=w.width,A=w.height,k=T/2+(L-E),P=M/2+($-D),R=a-E,I=r-D;d=m.rotateYMax*(R-k)/(b-T/2)*-1,p=m.rotateXMax*(I-P)/(A-M/2)}m.rotateLock&&(void 0===s&&(s=d,g=!0),void 0===n&&(n=p,y=!0),g&&(s<0&&(d<0&&(d=0),d>0&&(g=!1)),s>0&&(d>0&&(d=0),d<0&&(g=!1))),y&&(n<0&&(p<0&&(p=0),p>0&&(y=!1)),n>0&&(p>0&&(p=0),p<0&&(y=!1)))),p=Math.min(Math.max(-p,-m.rotateXMax),m.rotateXMax),m.rotateXInvert&&(p=-p),d=Math.min(Math.max(-d,-m.rotateYMax),m.rotateYMax),m.rotateYInvert&&(d=-d),"string"!=typeof m.rotateTouch||0===p&&0===d||(o||(o=!0,l.classList.add("atropos-rotate-touch")),t.cancelable&&t.preventDefault());var j=p/m.rotateXMax*100,C=d/m.rotateYMax*100,S=(l!==v?C/100*m.stretchX:0)*(m.rotateYInvert?-1:1),N=(l!==v?j/100*m.stretchY:0)*(m.rotateXInvert?-1:1);$setTransform(e,"translate3d("+S+"%, "+-N+"%, 0px) rotateX("+p+"deg) rotateY("+d+"deg)"),u&&($setDuration(u,"0ms"),$setTransform(u,"translate3d("+.25*-C+"%, "+.25*j+"%, 0)"),u.style.opacity=Math.max(Math.abs(j),Math.abs(C))/100),x({rotateXPercentage:j,rotateYPercentage:C,duration:"0ms"}),"function"==typeof m.onRotate&&m.onRotate(p,d)}},_=function(t){i=void 0,c=void 0,h.isActive&&(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType||("string"==typeof m.rotateTouch&&o&&l.classList.remove("atropos-rotate-touch"),l.classList.remove("atropos-active"),$setTransform(a,"translate3d(0,0, 0px)"),$setDuration(a,m.durationLeave+"ms"),p&&$setDuration(p,m.durationLeave+"ms"),u&&($setDuration(u,m.durationLeave+"ms"),$setTransform(u,"translate3d(0, 0, 0)"),u.style.opacity=0),$setDuration(e,m.durationLeave+"ms"),$setTransform(e,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),x({duration:m.durationLeave+"ms"}),h.isActive=!1,"function"==typeof m.onRotate&&m.onRotate(0,0),"function"==typeof m.onLeave&&m.onLeave()))},O=function(t){var e=t.target;!v.contains(e)&&e!==v&&h.isActive&&_()};return h.destroy=function(){h.destroyed=!0,$off(document,"click",O),$off(v,"pointerdown",L),$off(v,"pointerenter",L),$off(v,"pointermove",M),$off(v,"touchmove",T),$off(v,"pointerleave",_),$off(v,"pointerup",_),$off(v,"lostpointercapture",_),delete l.__atropos__},"string"==typeof l&&(l=$(document,l)),l&&(l.__atropos__||(void 0!==v?"string"==typeof v&&(v=$(document,v)):v=l,Object.assign(h,{el:l}),e=$(l,".atropos-rotate"),a=$(l,".atropos-scale"),r=$(l,".atropos-inner"),l.__atropos__=h)),l&&v&&(m.shadow&&((p=$(l,".atropos-shadow"))||((p=document.createElement("span")).classList.add("atropos-shadow"),d=!0),$setTransform(p,"translate3d(0,0,-"+m.shadowOffset+"px) scale("+m.shadowScale+")"),d&&e.appendChild(p)),m.highlight&&function(){var t;(u=$(l,".atropos-highlight"))||((u=document.createElement("span")).classList.add("atropos-highlight"),t=!0),$setTransform(u,"translate3d(0,0,0)"),t&&r.appendChild(u)}(),m.rotateTouch&&("string"==typeof m.rotateTouch?l.classList.add("atropos-rotate-touch-"+m.rotateTouch):l.classList.add("atropos-rotate-touch")),$(l,"[data-atropos-opacity]")&&x({opacityOnly:!0}),$on(document,"click",O),$on(v,"pointerdown",L),$on(v,"pointerenter",L),$on(v,"pointermove",M),$on(v,"touchmove",T),$on(v,"pointerleave",_),$on(v,"pointerup",_),$on(v,"lostpointercapture",_)),h}export{Atropos,Atropos as default};
//# sourceMappingURL=atropos.esm.browser.min.js.map