/**
 * Atropos 0.11.2
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2021 
 *
 * Released under the MIT License
 *
 * Released on: October 15, 2021
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Atropos=e()}(this,(function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var e=function(t,e){return t.querySelector(e)},o=function(t,e){t.style.transitionDuration=e},a=function(t,e){t.style.transform=e},r=function(t,e){t.style.opacity=e},n=function(t,e,o,a){return t.addEventListener(e,o,a)},i=function(t,e,o,a){return t.removeEventListener(e,o,a)},s=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};return function(c){void 0===c&&(c={});var p,d,u,l,f,v,h,y,m,g,L,x=c,M=x.el,X=x.eventsEl,Y={__atropos__:!0,params:t({activeOffset:50,shadowOffset:50,shadowScale:1,durationEnter:300,durationLeave:600,rotateLock:!0,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},s(c||{})),destroyed:!1,isActive:!1},_=Y.params,w=!0,O=!0,b=function(t){var e=t.rotateXPercentage,n=void 0===e?0:e,i=t.rotateYPercentage,s=void 0===i?0:i,c=t.duration,p=t.opacityOnly;(function(t,e){return t.querySelectorAll(e)})(M,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){o(t,c);var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===n&&0===s)p||a(t,"translate3d(0, 0, 0)"),e&&r(t,e[0]);else{var i=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(i)||p||a(t,"translate3d("+-s*-i+"%, "+n*-i+"%, 0)"),e){var d=e[0],u=e[1],l=Math.max(Math.abs(n),Math.abs(s));r(t,d+(u-d)*l/100)}}}))},T=function(t){"pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType||("pointerdown"===t.type&&t.preventDefault(),M.classList.add("atropos-active"),o(p,"0ms"),d=!1,f=void 0,v=void 0,w=!0,O=!0,a(u,"translate3d(0,0, "+_.activeOffset+"px)"),o(u,(_.rotateLock?_.durationEnter:0)+"ms"),m&&o(m,(_.rotateLock?_.durationEnter:0)+"ms"),Y.isActive=!0,"function"==typeof _.onEnter&&_.onEnter())},E=function(t){d&&t.cancelable&&t.preventDefault()},A=function(t){if(_.rotate&&Y.isActive){if("mouse"!==t.pointerType){if(!_.rotateTouch)return;t.preventDefault()}var e=t.clientX,r=t.clientY;h||(h=M.getBoundingClientRect()),M===X||y||(y=X.getBoundingClientRect());var n=0,i=0,s=h,c=s.top,u=s.left,l=s.width,m=s.height;if(M===X){var L=l/2,x=m/2,T=e-u,E=r-c;i=_.rotateYMax*(T-L)/(l/2)*-1,n=_.rotateXMax*(E-x)/(m/2)}else{var A=y,k=A.top,R=A.left,I=A.width,j=A.height,D=l/2+(u-R),P=m/2+(c-k),C=e-R,S=r-k;i=_.rotateYMax*(C-D)/(I-l/2)*-1,n=_.rotateXMax*(S-P)/(j-m/2)}_.rotateLock&&(void 0===v&&(v=i,O=!0),void 0===f&&(f=n,w=!0),O&&(v<0&&(i<0&&(i=0),i>0&&(O=!1)),v>0&&(i>0&&(i=0),i<0&&(O=!1))),w&&(f<0&&(n<0&&(n=0),n>0&&(w=!1)),f>0&&(n>0&&(n=0),n<0&&(w=!1)))),n=Math.min(Math.max(-n,-_.rotateXMax),_.rotateXMax),_.rotateXInvert&&(n=-n),i=Math.min(Math.max(-i,-_.rotateYMax),_.rotateYMax),_.rotateYInvert&&(i=-i),"string"!=typeof _.rotateTouch||0===n&&0===i||(d||(d=!0,M.classList.add("atropos-rotate-touch")),t.cancelable&&t.preventDefault());var N=n/_.rotateXMax*100,q=i/_.rotateYMax*100,B=(M!==X?q/100*_.stretchX:0)*(_.rotateYInvert?-1:1),F=(M!==X?N/100*_.stretchY:0)*(_.rotateXInvert?-1:1);a(p,"translate3d("+B+"%, "+-F+"%, 0px) rotateX("+n+"deg) rotateY("+i+"deg)"),g&&(o(g,"0ms"),a(g,"translate3d("+.25*-q+"%, "+.25*N+"%, 0)"),g.style.opacity=Math.max(Math.abs(N),Math.abs(q))/100),b({rotateXPercentage:N,rotateYPercentage:q,duration:"0ms"}),"function"==typeof _.onRotate&&_.onRotate(n,i)}},k=function(t){h=void 0,y=void 0,Y.isActive&&(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType||("string"==typeof _.rotateTouch&&d&&M.classList.remove("atropos-rotate-touch"),M.classList.remove("atropos-active"),a(u,"translate3d(0,0, 0px)"),o(u,_.durationLeave+"ms"),m&&o(m,_.durationLeave+"ms"),g&&(o(g,_.durationLeave+"ms"),a(g,"translate3d(0, 0, 0)"),g.style.opacity=0),o(p,_.durationLeave+"ms"),a(p,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),b({duration:_.durationLeave+"ms"}),Y.isActive=!1,"function"==typeof _.onRotate&&_.onRotate(0,0),"function"==typeof _.onLeave&&_.onLeave()))},R=function(t){var e=t.target;!X.contains(e)&&e!==X&&Y.isActive&&k()};return Y.destroy=function(){Y.destroyed=!0,i(document,"click",R),i(X,"pointerdown",T),i(X,"pointerenter",T),i(X,"pointermove",A),i(X,"touchmove",E),i(X,"pointerleave",k),i(X,"pointerup",k),i(X,"lostpointercapture",k),delete M.__atropos__},"string"==typeof M&&(M=e(document,M)),M&&(M.__atropos__||(void 0!==X?"string"==typeof X&&(X=e(document,X)):X=M,Object.assign(Y,{el:M}),p=e(M,".atropos-rotate"),u=e(M,".atropos-scale"),l=e(M,".atropos-inner"),M.__atropos__=Y)),M&&X&&(_.shadow&&((m=e(M,".atropos-shadow"))||((m=document.createElement("span")).classList.add("atropos-shadow"),L=!0),a(m,"translate3d(0,0,-"+_.shadowOffset+"px) scale("+_.shadowScale+")"),L&&p.appendChild(m)),_.highlight&&function(){var t;(g=e(M,".atropos-highlight"))||((g=document.createElement("span")).classList.add("atropos-highlight"),t=!0),a(g,"translate3d(0,0,0)"),t&&l.appendChild(g)}(),_.rotateTouch&&("string"==typeof _.rotateTouch?M.classList.add("atropos-rotate-touch-"+_.rotateTouch):M.classList.add("atropos-rotate-touch")),e(M,"[data-atropos-opacity]")&&b({opacityOnly:!0}),n(document,"click",R),n(X,"pointerdown",T),n(X,"pointerenter",T),n(X,"pointermove",A),n(X,"touchmove",E),n(X,"pointerleave",k),n(X,"pointerup",k),n(X,"lostpointercapture",k)),Y}}));
//# sourceMappingURL=atropos.min.js.map